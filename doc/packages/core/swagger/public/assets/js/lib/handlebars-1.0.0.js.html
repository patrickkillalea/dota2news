<!DOCTYPE html>
<html>
<head>
  <title>handlebars-1.0.0.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../../doc-style.css" />
  <script src="../../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../../", thisFile = "packages/core/swagger/public/assets/js/lib/handlebars-1.0.0.js", defaultSidebar = true;
  </script>
  <script src="../../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>handlebars-1.0.0.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body"><p>Copyright (C) 2011 by Yehuda Katz</p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>lib/handlebars/browser-prefix.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">Handlebars</span> <span class="o">=</span> <span class="p">{};</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Handlebars</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>lib/handlebars/base.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VERSION</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">;</span>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">COMPILER_REVISION</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">REVISION_CHANGES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="o">:</span> <span class="s1">&#39;&lt;= 1.0.rc.2&#39;</span><span class="p">,</span> <span class="c1">// 1.0.rc.2 is actually rev2 but doesn&#39;t report it</span>
  <span class="mi">2</span><span class="o">:</span> <span class="s1">&#39;== 1.0.0-rc.3&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="o">:</span> <span class="s1">&#39;== 1.0.0-rc.4&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="o">:</span> <span class="s1">&#39;&gt;= 1.0.0&#39;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">helpers</span>  <span class="o">=</span> <span class="p">{};</span>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">partials</span> <span class="o">=</span> <span class="p">{};</span>

<span class="kd">var</span> <span class="nx">toString</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span>
    <span class="nx">functionType</span> <span class="o">=</span> <span class="s1">&#39;[object Function]&#39;</span><span class="p">,</span>
    <span class="nx">objectType</span> <span class="o">=</span> <span class="s1">&#39;[object Object]&#39;</span><span class="p">;</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">===</span> <span class="nx">objectType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inverse</span> <span class="o">||</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;Arg not supported with multiple helpers&#39;</span><span class="p">);</span> <span class="p">}</span>
    <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">helpers</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">not</span> <span class="o">=</span> <span class="nx">inverse</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">helpers</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerPartial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">===</span> <span class="nx">objectType</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">partials</span><span class="p">,</span>  <span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">partials</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;helperMissing&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Missing helper: &#39;&quot;</span> <span class="o">+</span> <span class="nx">arg</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;blockHelperMissing&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">inverse</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inverse</span> <span class="o">||</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">functionType</span><span class="p">)</span> <span class="p">{</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">context</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">context</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">context</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">inverse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;[object Array]&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">inverse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">K</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">createFrame</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="o">||</span> <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">K</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">object</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">K</span><span class="p">();</span>
  <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">K</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">DEBUG</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">INFO</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">WARN</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">ERROR</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">level</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>

  <span class="nx">methodMap</span><span class="o">:</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="o">:</span> <span class="s1">&#39;error&#39;</span><span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>can be overridden in the host environment</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">log</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">level</span> <span class="o">&lt;=</span> <span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">methodMap</span><span class="p">[</span><span class="nx">level</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">console</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">console</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span> <span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;each&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">inverse</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inverse</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">functionType</span><span class="p">)</span> <span class="p">{</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">data</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">createFrame</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">context</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">context</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">){</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">j</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="nx">data</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ret</span> <span class="o">=</span> <span class="nx">ret</span> <span class="o">+</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">context</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="p">{</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span> <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="nx">data</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span> <span class="p">}</span>
          <span class="nx">ret</span> <span class="o">=</span> <span class="nx">ret</span> <span class="o">+</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">context</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">});</span>
          <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">){</span>
    <span class="nx">ret</span> <span class="o">=</span> <span class="nx">inverse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;if&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conditional</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">conditional</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">functionType</span><span class="p">)</span> <span class="p">{</span> <span class="nx">conditional</span> <span class="o">=</span> <span class="nx">conditional</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">conditional</span> <span class="o">||</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">conditional</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inverse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fn</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;unless&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conditional</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">helpers</span><span class="p">[</span><span class="s1">&#39;if&#39;</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">conditional</span><span class="p">,</span> <span class="p">{</span><span class="nx">fn</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inverse</span><span class="p">,</span> <span class="nx">inverse</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fn</span><span class="p">});</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">functionType</span><span class="p">)</span> <span class="p">{</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">context</span><span class="p">))</span> <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fn</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">level</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">level</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">level</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
  <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
<span class="p">});</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>lib/handlebars/compiler/parser.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="cm">/* Jison generated parser */</span>
<span class="kd">var</span> <span class="nx">handlebars</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="p">{</span><span class="nx">trace</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">trace</span><span class="p">()</span> <span class="p">{</span> <span class="p">},</span>
<span class="nx">yy</span><span class="o">:</span> <span class="p">{},</span>
<span class="nx">symbols_</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;root&quot;</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;program&quot;</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;EOF&quot;</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;simpleInverse&quot;</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;statements&quot;</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="s2">&quot;statement&quot;</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="s2">&quot;openInverse&quot;</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="s2">&quot;closeBlock&quot;</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;openBlock&quot;</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="s2">&quot;mustache&quot;</span><span class="o">:</span><span class="mi">12</span><span class="p">,</span><span class="s2">&quot;partial&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;CONTENT&quot;</span><span class="o">:</span><span class="mi">14</span><span class="p">,</span><span class="s2">&quot;COMMENT&quot;</span><span class="o">:</span><span class="mi">15</span><span class="p">,</span><span class="s2">&quot;OPEN_BLOCK&quot;</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="s2">&quot;inMustache&quot;</span><span class="o">:</span><span class="mi">17</span><span class="p">,</span><span class="s2">&quot;CLOSE&quot;</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span><span class="s2">&quot;OPEN_INVERSE&quot;</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="s2">&quot;OPEN_ENDBLOCK&quot;</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;path&quot;</span><span class="o">:</span><span class="mi">21</span><span class="p">,</span><span class="s2">&quot;OPEN&quot;</span><span class="o">:</span><span class="mi">22</span><span class="p">,</span><span class="s2">&quot;OPEN_UNESCAPED&quot;</span><span class="o">:</span><span class="mi">23</span><span class="p">,</span><span class="s2">&quot;CLOSE_UNESCAPED&quot;</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="s2">&quot;OPEN_PARTIAL&quot;</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="s2">&quot;partialName&quot;</span><span class="o">:</span><span class="mi">26</span><span class="p">,</span><span class="s2">&quot;params&quot;</span><span class="o">:</span><span class="mi">27</span><span class="p">,</span><span class="s2">&quot;hash&quot;</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="s2">&quot;dataName&quot;</span><span class="o">:</span><span class="mi">29</span><span class="p">,</span><span class="s2">&quot;param&quot;</span><span class="o">:</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;STRING&quot;</span><span class="o">:</span><span class="mi">31</span><span class="p">,</span><span class="s2">&quot;INTEGER&quot;</span><span class="o">:</span><span class="mi">32</span><span class="p">,</span><span class="s2">&quot;BOOLEAN&quot;</span><span class="o">:</span><span class="mi">33</span><span class="p">,</span><span class="s2">&quot;hashSegments&quot;</span><span class="o">:</span><span class="mi">34</span><span class="p">,</span><span class="s2">&quot;hashSegment&quot;</span><span class="o">:</span><span class="mi">35</span><span class="p">,</span><span class="s2">&quot;ID&quot;</span><span class="o">:</span><span class="mi">36</span><span class="p">,</span><span class="s2">&quot;EQUALS&quot;</span><span class="o">:</span><span class="mi">37</span><span class="p">,</span><span class="s2">&quot;DATA&quot;</span><span class="o">:</span><span class="mi">38</span><span class="p">,</span><span class="s2">&quot;pathSegments&quot;</span><span class="o">:</span><span class="mi">39</span><span class="p">,</span><span class="s2">&quot;SEP&quot;</span><span class="o">:</span><span class="mi">40</span><span class="p">,</span><span class="s2">&quot;$accept&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;$end&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span>
<span class="nx">terminals_</span><span class="o">:</span> <span class="p">{</span><span class="mi">2</span><span class="o">:</span><span class="s2">&quot;error&quot;</span><span class="p">,</span><span class="mi">5</span><span class="o">:</span><span class="s2">&quot;EOF&quot;</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="s2">&quot;CONTENT&quot;</span><span class="p">,</span><span class="mi">15</span><span class="o">:</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">,</span><span class="mi">16</span><span class="o">:</span><span class="s2">&quot;OPEN_BLOCK&quot;</span><span class="p">,</span><span class="mi">18</span><span class="o">:</span><span class="s2">&quot;CLOSE&quot;</span><span class="p">,</span><span class="mi">19</span><span class="o">:</span><span class="s2">&quot;OPEN_INVERSE&quot;</span><span class="p">,</span><span class="mi">20</span><span class="o">:</span><span class="s2">&quot;OPEN_ENDBLOCK&quot;</span><span class="p">,</span><span class="mi">22</span><span class="o">:</span><span class="s2">&quot;OPEN&quot;</span><span class="p">,</span><span class="mi">23</span><span class="o">:</span><span class="s2">&quot;OPEN_UNESCAPED&quot;</span><span class="p">,</span><span class="mi">24</span><span class="o">:</span><span class="s2">&quot;CLOSE_UNESCAPED&quot;</span><span class="p">,</span><span class="mi">25</span><span class="o">:</span><span class="s2">&quot;OPEN_PARTIAL&quot;</span><span class="p">,</span><span class="mi">31</span><span class="o">:</span><span class="s2">&quot;STRING&quot;</span><span class="p">,</span><span class="mi">32</span><span class="o">:</span><span class="s2">&quot;INTEGER&quot;</span><span class="p">,</span><span class="mi">33</span><span class="o">:</span><span class="s2">&quot;BOOLEAN&quot;</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span><span class="mi">37</span><span class="o">:</span><span class="s2">&quot;EQUALS&quot;</span><span class="p">,</span><span class="mi">38</span><span class="o">:</span><span class="s2">&quot;DATA&quot;</span><span class="p">,</span><span class="mi">40</span><span class="o">:</span><span class="s2">&quot;SEP&quot;</span><span class="p">},</span>
<span class="nx">productions_</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">27</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">27</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">34</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">34</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">29</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">39</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">39</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
<span class="nx">performAction</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">anonymous</span><span class="p">(</span><span class="nx">yytext</span><span class="p">,</span><span class="nx">yyleng</span><span class="p">,</span><span class="nx">yylineno</span><span class="p">,</span><span class="nx">yy</span><span class="p">,</span><span class="nx">yystate</span><span class="p">,</span><span class="nx">$$</span><span class="p">,</span><span class="nx">_$</span><span class="p">)</span> <span class="p">{</span>

<span class="kd">var</span> <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">switch</span> <span class="p">(</span><span class="nx">yystate</span><span class="p">)</span> <span class="p">{</span>
<span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">return</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">([],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">5</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">6</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">([],</span> <span class="p">[]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">7</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">([]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">8</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">9</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">BlockNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">inverse</span><span class="p">,</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">11</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">BlockNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">inverse</span><span class="p">,</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">12</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">14</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">ContentNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">15</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">CommentNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">16</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">MustacheNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">17</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">MustacheNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">18</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">19</span><span class="o">:</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>Parsing out the '&amp;' escape token at this level saves ~500 bytes after min due to the removal of one parser node.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">MustacheNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
  
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">20</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">MustacheNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">21</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">PartialNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">22</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">PartialNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">23</span><span class="o">:</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">24</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">25</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]),</span> <span class="kc">null</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">26</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">27</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]],</span> <span class="kc">null</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">28</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]],</span> <span class="kc">null</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">29</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">30</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">31</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">32</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">StringNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">33</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">IntegerNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">34</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">BooleanNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">35</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">36</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">HashNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">37</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">38</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">39</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">40</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">StringNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">])];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">41</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">IntegerNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">])];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">42</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">BooleanNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">])];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">43</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">44</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">PartialNameNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">45</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">PartialNameNode</span><span class="p">(</span><span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">StringNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]));</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">46</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">PartialNameNode</span><span class="p">(</span><span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">IntegerNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]));</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">47</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">DataNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">48</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">yy</span><span class="p">.</span><span class="nx">IdNode</span><span class="p">(</span><span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">49</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="nx">push</span><span class="p">({</span><span class="nx">part</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">],</span> <span class="nx">separator</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">1</span><span class="p">]});</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="o">-</span><span class="mi">2</span><span class="p">];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">50</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">part</span><span class="o">:</span> <span class="nx">$$</span><span class="p">[</span><span class="nx">$0</span><span class="p">]}];</span> 
<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">},</span>
<span class="nx">table</span><span class="o">:</span> <span class="p">[{</span><span class="mi">3</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="mi">6</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">1</span><span class="o">:</span><span class="p">[</span><span class="mi">3</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">7</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">6</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">17</span><span class="o">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">21</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">]},{</span><span class="mi">4</span><span class="o">:</span><span class="mi">29</span><span class="p">,</span><span class="mi">6</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">4</span><span class="o">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">6</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">]},{</span><span class="mi">17</span><span class="o">:</span><span class="mi">31</span><span class="p">,</span><span class="mi">21</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">17</span><span class="o">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">21</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">17</span><span class="o">:</span><span class="mi">33</span><span class="p">,</span><span class="mi">21</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">21</span><span class="o">:</span><span class="mi">35</span><span class="p">,</span><span class="mi">26</span><span class="o">:</span><span class="mi">34</span><span class="p">,</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">36</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">1</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">8</span><span class="o">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">17</span><span class="o">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">21</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="mi">7</span><span class="o">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">39</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">21</span><span class="o">:</span><span class="mi">44</span><span class="p">,</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">27</span><span class="o">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">28</span><span class="o">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="o">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">46</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">34</span><span class="o">:</span><span class="mi">43</span><span class="p">,</span><span class="mi">35</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">28</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">],</span><span class="mi">40</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">51</span><span class="p">]},{</span><span class="mi">21</span><span class="o">:</span><span class="mi">52</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">40</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">]},{</span><span class="mi">10</span><span class="o">:</span><span class="mi">53</span><span class="p">,</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">54</span><span class="p">]},{</span><span class="mi">10</span><span class="o">:</span><span class="mi">55</span><span class="p">,</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">54</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">56</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">57</span><span class="p">]},{</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">58</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">59</span><span class="p">],</span><span class="mi">21</span><span class="o">:</span><span class="mi">60</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">44</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">44</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">46</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">46</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">8</span><span class="o">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span><span class="mi">21</span><span class="o">:</span><span class="mi">44</span><span class="p">,</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span><span class="mi">28</span><span class="o">:</span><span class="mi">61</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="o">:</span><span class="mi">62</span><span class="p">,</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">46</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">34</span><span class="o">:</span><span class="mi">43</span><span class="p">,</span><span class="mi">35</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">26</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">36</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">36</span><span class="p">],</span><span class="mi">35</span><span class="o">:</span><span class="mi">63</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">64</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">32</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">33</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">34</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">35</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">37</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">65</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="mi">40</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">]},{</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">66</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">47</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">]},{</span><span class="mi">21</span><span class="o">:</span><span class="mi">67</span><span class="p">,</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">]},{</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">68</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">24</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">29</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">]},{</span><span class="mi">37</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">65</span><span class="p">]},{</span><span class="mi">21</span><span class="o">:</span><span class="mi">69</span><span class="p">,</span><span class="mi">29</span><span class="o">:</span><span class="mi">73</span><span class="p">,</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">70</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">71</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">72</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="mi">39</span><span class="o">:</span><span class="mi">26</span><span class="p">},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">31</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">32</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">33</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">38</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">],</span><span class="mi">40</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">49</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">74</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">39</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">39</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">39</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">41</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">41</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">41</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">42</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">42</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">42</span><span class="p">]},{</span><span class="mi">18</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">43</span><span class="p">],</span><span class="mi">24</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">43</span><span class="p">],</span><span class="mi">36</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">43</span><span class="p">]},{</span><span class="mi">5</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">14</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">15</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">16</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">19</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">20</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">22</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">23</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span><span class="mi">25</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">]}],</span>
<span class="nx">defaultActions</span><span class="o">:</span> <span class="p">{</span><span class="mi">17</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]},</span>
<span class="nx">parseError</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">parseError</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">parse</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">stack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">vstack</span> <span class="o">=</span> <span class="p">[</span><span class="kc">null</span><span class="p">],</span> <span class="nx">lstack</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">table</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">table</span><span class="p">,</span> <span class="nx">yytext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">yylineno</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">yyleng</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">recovering</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">TERROR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">EOF</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yy</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">lexer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">parser</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylloc</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylloc</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">var</span> <span class="nx">yyloc</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">;</span>
    <span class="nx">lstack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">yyloc</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">ranges</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">options</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ranges</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">parseError</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">parseError</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">parseError</span><span class="p">;</span>
    <span class="kd">function</span> <span class="nx">popStack</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">n</span><span class="p">;</span>
        <span class="nx">vstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">vstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">n</span><span class="p">;</span>
        <span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">n</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">lex</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">token</span><span class="p">;</span>
        <span class="nx">token</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">lex</span><span class="p">()</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">token</span> <span class="o">!==</span> <span class="s2">&quot;number&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">token</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">symbols_</span><span class="p">[</span><span class="nx">token</span><span class="p">]</span> <span class="o">||</span> <span class="nx">token</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">symbol</span><span class="p">,</span> <span class="nx">preErrorSymbol</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">action</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">yyval</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">newState</span><span class="p">,</span> <span class="nx">expected</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">state</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">[</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">defaultActions</span><span class="p">[</span><span class="nx">state</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">action</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultActions</span><span class="p">[</span><span class="nx">state</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">symbol</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">symbol</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">symbol</span> <span class="o">=</span> <span class="nx">lex</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="nx">action</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">state</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">table</span><span class="p">[</span><span class="nx">state</span><span class="p">][</span><span class="nx">symbol</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">action</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">action</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="o">!</span><span class="nx">action</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">errStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">recovering</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">expected</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">p</span> <span class="k">in</span> <span class="nx">table</span><span class="p">[</span><span class="nx">state</span><span class="p">])</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">terminals_</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">p</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">expected</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">terminals_</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">showPosition</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">errStr</span> <span class="o">=</span> <span class="s2">&quot;Parse error on line &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">yylineno</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:\n&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">showPosition</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;\nExpecting &quot;</span> <span class="o">+</span> <span class="nx">expected</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, got &#39;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">terminals_</span><span class="p">[</span><span class="nx">symbol</span><span class="p">]</span> <span class="o">||</span> <span class="nx">symbol</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">errStr</span> <span class="o">=</span> <span class="s2">&quot;Parse error on line &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">yylineno</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: Unexpected &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">symbol</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot;end of input&quot;</span><span class="o">:</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">terminals_</span><span class="p">[</span><span class="nx">symbol</span><span class="p">]</span> <span class="o">||</span> <span class="nx">symbol</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">parseError</span><span class="p">(</span><span class="nx">errStr</span><span class="p">,</span> <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">match</span><span class="p">,</span> <span class="nx">token</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">terminals_</span><span class="p">[</span><span class="nx">symbol</span><span class="p">]</span> <span class="o">||</span> <span class="nx">symbol</span><span class="p">,</span> <span class="nx">line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylineno</span><span class="p">,</span> <span class="nx">loc</span><span class="o">:</span> <span class="nx">yyloc</span><span class="p">,</span> <span class="nx">expected</span><span class="o">:</span> <span class="nx">expected</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nb">Array</span> <span class="o">&amp;&amp;</span> <span class="nx">action</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Parse Error: multiple actions possible at state: &quot;</span> <span class="o">+</span> <span class="nx">state</span> <span class="o">+</span> <span class="s2">&quot;, token: &quot;</span> <span class="o">+</span> <span class="nx">symbol</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">symbol</span><span class="p">);</span>
            <span class="nx">vstack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yytext</span><span class="p">);</span>
            <span class="nx">lstack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">);</span>
            <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
            <span class="nx">symbol</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preErrorSymbol</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">yyleng</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yyleng</span><span class="p">;</span>
                <span class="nx">yytext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yytext</span><span class="p">;</span>
                <span class="nx">yylineno</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylineno</span><span class="p">;</span>
                <span class="nx">yyloc</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">recovering</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="nx">recovering</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">symbol</span> <span class="o">=</span> <span class="nx">preErrorSymbol</span><span class="p">;</span>
                <span class="nx">preErrorSymbol</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">productions_</span><span class="p">[</span><span class="nx">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">];</span>
            <span class="nx">yyval</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">vstack</span><span class="p">[</span><span class="nx">vstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">len</span><span class="p">];</span>
            <span class="nx">yyval</span><span class="p">.</span><span class="nx">_$</span> <span class="o">=</span> <span class="p">{</span><span class="nx">first_line</span><span class="o">:</span> <span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="p">(</span><span class="nx">len</span> <span class="o">||</span> <span class="mi">1</span><span class="p">)].</span><span class="nx">first_line</span><span class="p">,</span> <span class="nx">last_line</span><span class="o">:</span> <span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">last_line</span><span class="p">,</span> <span class="nx">first_column</span><span class="o">:</span> <span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="p">(</span><span class="nx">len</span> <span class="o">||</span> <span class="mi">1</span><span class="p">)].</span><span class="nx">first_column</span><span class="p">,</span> <span class="nx">last_column</span><span class="o">:</span> <span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">last_column</span><span class="p">};</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ranges</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">yyval</span><span class="p">.</span><span class="nx">_$</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="p">[</span><span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="p">(</span><span class="nx">len</span> <span class="o">||</span> <span class="mi">1</span><span class="p">)].</span><span class="nx">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">lstack</span><span class="p">[</span><span class="nx">lstack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span>
            <span class="p">}</span>
            <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">performAction</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yyval</span><span class="p">,</span> <span class="nx">yytext</span><span class="p">,</span> <span class="nx">yyleng</span><span class="p">,</span> <span class="nx">yylineno</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">,</span> <span class="nx">action</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">vstack</span><span class="p">,</span> <span class="nx">lstack</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">stack</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">len</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
                <span class="nx">vstack</span> <span class="o">=</span> <span class="nx">vstack</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">len</span><span class="p">);</span>
                <span class="nx">lstack</span> <span class="o">=</span> <span class="nx">lstack</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">len</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">productions_</span><span class="p">[</span><span class="nx">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]);</span>
            <span class="nx">vstack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">yyval</span><span class="p">.</span><span class="nx">$</span><span class="p">);</span>
            <span class="nx">lstack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">yyval</span><span class="p">.</span><span class="nx">_$</span><span class="p">);</span>
            <span class="nx">newState</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">stack</span><span class="p">[</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]][</span><span class="nx">stack</span><span class="p">[</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]];</span>
            <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">};</span>
<span class="cm">/* Jison generated lexer */</span>
<span class="kd">var</span> <span class="nx">lexer</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<span class="kd">var</span> <span class="nx">lexer</span> <span class="o">=</span> <span class="p">({</span><span class="nx">EOF</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="nx">parseError</span><span class="o">:</span><span class="kd">function</span> <span class="nx">parseError</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">parser</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">parseError</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">hash</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="nx">setInput</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="nx">input</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_more</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_less</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">done</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yyleng</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">matched</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;INITIAL&#39;</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span> <span class="o">=</span> <span class="p">{</span><span class="nx">first_line</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">first_column</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">last_line</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">last_column</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ranges</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">input</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ch</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">+=</span> <span class="nx">ch</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">++</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="o">++</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">match</span> <span class="o">+=</span> <span class="nx">ch</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">matched</span> <span class="o">+=</span> <span class="nx">ch</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nx">ch</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/(?:\r\n?|\n).*/g</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">lines</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span><span class="o">++</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">last_line</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">last_column</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ranges</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">ch</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">unput</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">ch</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nx">ch</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/(?:\r\n?|\n)/g</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="nx">ch</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="nx">len</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>this.yyleng -= len;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">offset</span> <span class="o">-=</span> <span class="nx">len</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">oldLines</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/(?:\r\n?|\n)/g</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">match</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">matched</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">matched</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">matched</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span> <span class="o">-=</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">range</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span> <span class="o">=</span> <span class="p">{</span><span class="nx">first_line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">first_line</span><span class="p">,</span>
          <span class="nx">last_line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
          <span class="nx">first_column</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">first_column</span><span class="p">,</span>
          <span class="nx">last_column</span><span class="o">:</span> <span class="nx">lines</span> <span class="o">?</span>
              <span class="p">(</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">oldLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">first_column</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nx">oldLines</span><span class="p">[</span><span class="nx">oldLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">].</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="o">:</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">first_column</span> <span class="o">-</span> <span class="nx">len</span>
          <span class="p">};</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ranges</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="p">[</span><span class="nx">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">yyleng</span> <span class="o">-</span> <span class="nx">len</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">more</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_more</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">less</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">unput</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">n</span><span class="p">));</span>
    <span class="p">},</span>
<span class="nx">pastInput</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">past</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">matched</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">matched</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">past</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">20</span> <span class="o">?</span> <span class="s1">&#39;...&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">past</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="nx">upcomingInput</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">next</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">next</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">next</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="o">-</span><span class="nx">next</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">next</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">next</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">20</span> <span class="o">?</span> <span class="s1">&#39;...&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="nx">showPosition</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pre</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pastInput</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">pre</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">pre</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">upcomingInput</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;\n&quot;</span> <span class="o">+</span> <span class="nx">c</span><span class="o">+</span><span class="s2">&quot;^&quot;</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">next</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">EOF</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">done</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">token</span><span class="p">,</span>
            <span class="nx">match</span><span class="p">,</span>
            <span class="nx">tempMatch</span><span class="p">,</span>
            <span class="nx">index</span><span class="p">,</span>
            <span class="nx">col</span><span class="p">,</span>
            <span class="nx">lines</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_more</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">match</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">rules</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentRules</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rules</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tempMatch</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">tempMatch</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">match</span> <span class="o">||</span> <span class="nx">tempMatch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">match</span> <span class="o">=</span> <span class="nx">tempMatch</span><span class="p">;</span>
                <span class="nx">index</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">flex</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lines</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="sr">/(?:\r\n?|\n).*/g</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">lines</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span> <span class="o">+=</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span> <span class="o">=</span> <span class="p">{</span><span class="nx">first_line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">last_line</span><span class="p">,</span>
                           <span class="nx">last_line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                           <span class="nx">first_column</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">last_column</span><span class="p">,</span>
                           <span class="nx">last_column</span><span class="o">:</span> <span class="nx">lines</span> <span class="o">?</span> <span class="nx">lines</span><span class="p">[</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="o">-</span><span class="nx">lines</span><span class="p">[</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\r?\n?/</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">last_column</span> <span class="o">+</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">+=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">match</span> <span class="o">+=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">matches</span> <span class="o">=</span> <span class="nx">match</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yyleng</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ranges</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">yylloc</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yyleng</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_more</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">matched</span> <span class="o">+=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">token</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">performAction</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">rules</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span><span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">done</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">done</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">EOF</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseError</span><span class="p">(</span><span class="s1">&#39;Lexical error on line &#39;</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;. Unrecognized text.\n&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">showPosition</span><span class="p">(),</span>
                    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">token</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yylineno</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="nx">lex</span><span class="o">:</span><span class="kd">function</span> <span class="nx">lex</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">lex</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="nx">begin</span><span class="o">:</span><span class="kd">function</span> <span class="nx">begin</span><span class="p">(</span><span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">condition</span><span class="p">);</span>
    <span class="p">},</span>
<span class="nx">popState</span><span class="o">:</span><span class="kd">function</span> <span class="nx">popState</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="p">},</span>
<span class="nx">_currentRules</span><span class="o">:</span><span class="kd">function</span> <span class="nx">_currentRules</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditions</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]].</span><span class="nx">rules</span><span class="p">;</span>
    <span class="p">},</span>
<span class="nx">topState</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">conditionStack</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">2</span><span class="p">];</span>
    <span class="p">},</span>
<span class="nx">pushState</span><span class="o">:</span><span class="kd">function</span> <span class="nx">begin</span><span class="p">(</span><span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span><span class="nx">condition</span><span class="p">);</span>
    <span class="p">}});</span>
<span class="nx">lexer</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">lexer</span><span class="p">.</span><span class="nx">performAction</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">anonymous</span><span class="p">(</span><span class="nx">yy</span><span class="p">,</span><span class="nx">yy_</span><span class="p">,</span><span class="nx">$avoiding_name_collisions</span><span class="p">,</span><span class="nx">YY_START</span><span class="p">)</span> <span class="p">{</span>

<span class="kd">var</span> <span class="nx">YYSTATE</span><span class="o">=</span><span class="nx">YY_START</span>
<span class="k">switch</span><span class="p">(</span><span class="nx">$avoiding_name_collisions</span><span class="p">)</span> <span class="p">{</span>
<span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="s2">&quot;\\&quot;</span><span class="p">;</span> <span class="k">return</span> <span class="mi">14</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                                   <span class="k">if</span><span class="p">(</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!==</span> <span class="s2">&quot;\\&quot;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">);</span>
                                   <span class="k">if</span><span class="p">(</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;\\&quot;</span><span class="p">)</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span><span class="s2">&quot;emu&quot;</span><span class="p">);</span>
                                   <span class="k">if</span><span class="p">(</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">)</span> <span class="k">return</span> <span class="mi">14</span><span class="p">;</span>
                                 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">return</span> <span class="mi">14</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                                   <span class="k">if</span><span class="p">(</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!==</span> <span class="s2">&quot;\\&quot;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span>
                                   <span class="k">if</span><span class="p">(</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;\\&quot;</span><span class="p">)</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
                                   <span class="k">return</span> <span class="mi">14</span><span class="p">;</span>
                                 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span> <span class="k">return</span> <span class="mi">15</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">5</span><span class="o">:</span> <span class="k">return</span> <span class="mi">25</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">6</span><span class="o">:</span> <span class="k">return</span> <span class="mi">16</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">7</span><span class="o">:</span> <span class="k">return</span> <span class="mi">20</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">8</span><span class="o">:</span> <span class="k">return</span> <span class="mi">19</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">9</span><span class="o">:</span> <span class="k">return</span> <span class="mi">19</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="k">return</span> <span class="mi">23</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">11</span><span class="o">:</span> <span class="k">return</span> <span class="mi">22</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">12</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span> <span class="k">this</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span><span class="s1">&#39;com&#39;</span><span class="p">);</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">5</span><span class="p">);</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span> <span class="k">return</span> <span class="mi">15</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">14</span><span class="o">:</span> <span class="k">return</span> <span class="mi">22</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">15</span><span class="o">:</span> <span class="k">return</span> <span class="mi">37</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">16</span><span class="o">:</span> <span class="k">return</span> <span class="mi">36</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">17</span><span class="o">:</span> <span class="k">return</span> <span class="mi">36</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">18</span><span class="o">:</span> <span class="k">return</span> <span class="mi">40</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">19</span><span class="o">:</span> <span class="cm">/*ignore whitespace*/</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">20</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span> <span class="k">return</span> <span class="mi">24</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">21</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">popState</span><span class="p">();</span> <span class="k">return</span> <span class="mi">18</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">22</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">2</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\&quot;/g</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="p">);</span> <span class="k">return</span> <span class="mi">31</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">23</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">2</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\&#39;/g</span><span class="p">,</span><span class="s2">&quot;&#39;&quot;</span><span class="p">);</span> <span class="k">return</span> <span class="mi">31</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">24</span><span class="o">:</span> <span class="k">return</span> <span class="mi">38</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">25</span><span class="o">:</span> <span class="k">return</span> <span class="mi">33</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">26</span><span class="o">:</span> <span class="k">return</span> <span class="mi">33</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">27</span><span class="o">:</span> <span class="k">return</span> <span class="mi">32</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">28</span><span class="o">:</span> <span class="k">return</span> <span class="mi">36</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">29</span><span class="o">:</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span> <span class="o">=</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yytext</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">yy_</span><span class="p">.</span><span class="nx">yyleng</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="k">return</span> <span class="mi">36</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">30</span><span class="o">:</span> <span class="k">return</span> <span class="s1">&#39;INVALID&#39;</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="mi">31</span><span class="o">:</span> <span class="k">return</span> <span class="mi">5</span><span class="p">;</span> 
<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">};</span>
<span class="nx">lexer</span><span class="p">.</span><span class="nx">rules</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^(?:\\\\(?=(\{\{)))/</span><span class="p">,</span><span class="sr">/^(?:[^\x00]*?(?=(\{\{)))/</span><span class="p">,</span><span class="sr">/^(?:[^\x00]+)/</span><span class="p">,</span><span class="sr">/^(?:[^\x00]{2,}?(?=(\{\{|$)))/</span><span class="p">,</span><span class="sr">/^(?:[\s\S]*?--\}\})/</span><span class="p">,</span><span class="sr">/^(?:\{\{&gt;)/</span><span class="p">,</span><span class="sr">/^(?:\{\{#)/</span><span class="p">,</span><span class="sr">/^(?:\{\{\/)/</span><span class="p">,</span><span class="sr">/^(?:\{\{\^)/</span><span class="p">,</span><span class="sr">/^(?:\{\{\s*else\b)/</span><span class="p">,</span><span class="sr">/^(?:\{\{\{)/</span><span class="p">,</span><span class="sr">/^(?:\{\{&amp;)/</span><span class="p">,</span><span class="sr">/^(?:\{\{!--)/</span><span class="p">,</span><span class="sr">/^(?:\{\{![\s\S]*?\}\})/</span><span class="p">,</span><span class="sr">/^(?:\{\{)/</span><span class="p">,</span><span class="sr">/^(?:=)/</span><span class="p">,</span><span class="sr">/^(?:\.(?=[}\/ ]))/</span><span class="p">,</span><span class="sr">/^(?:\.\.)/</span><span class="p">,</span><span class="sr">/^(?:[\/.])/</span><span class="p">,</span><span class="sr">/^(?:\s+)/</span><span class="p">,</span><span class="sr">/^(?:\}\}\})/</span><span class="p">,</span><span class="sr">/^(?:\}\})/</span><span class="p">,</span><span class="sr">/^(?:&quot;(\\[&quot;]|[^&quot;])*&quot;)/</span><span class="p">,</span><span class="sr">/^(?:&#39;(\\[&#39;]|[^&#39;])*&#39;)/</span><span class="p">,</span><span class="sr">/^(?:@)/</span><span class="p">,</span><span class="sr">/^(?:true(?=[}\s]))/</span><span class="p">,</span><span class="sr">/^(?:false(?=[}\s]))/</span><span class="p">,</span><span class="sr">/^(?:-?[0-9]+(?=[}\s]))/</span><span class="p">,</span><span class="sr">/^(?:[^\s!&quot;#%-,\.\/;-&gt;@\[-\^`\{-~]+(?=[=}\s\/.]))/</span><span class="p">,</span><span class="sr">/^(?:\[[^\]]*\])/</span><span class="p">,</span><span class="sr">/^(?:.)/</span><span class="p">,</span><span class="sr">/^(?:$)/</span><span class="p">];</span>
<span class="nx">lexer</span><span class="p">.</span><span class="nx">conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mu&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;rules&quot;</span><span class="o">:</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="s2">&quot;inclusive&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">},</span><span class="s2">&quot;emu&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;rules&quot;</span><span class="o">:</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;inclusive&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">},</span><span class="s2">&quot;com&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;rules&quot;</span><span class="o">:</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="s2">&quot;inclusive&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">},</span><span class="s2">&quot;INITIAL&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;rules&quot;</span><span class="o">:</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span><span class="s2">&quot;inclusive&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">}};</span>
<span class="k">return</span> <span class="nx">lexer</span><span class="p">;})()</span>
<span class="nx">parser</span><span class="p">.</span><span class="nx">lexer</span> <span class="o">=</span> <span class="nx">lexer</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">Parser</span> <span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">yy</span> <span class="o">=</span> <span class="p">{};</span> <span class="p">}</span><span class="nx">Parser</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">;</span><span class="nx">parser</span><span class="p">.</span><span class="nx">Parser</span> <span class="o">=</span> <span class="nx">Parser</span><span class="p">;</span>
<span class="k">return</span> <span class="k">new</span> <span class="nx">Parser</span><span class="p">;</span>
<span class="p">})();;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>lib/handlebars/compiler/base.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Parser</span> <span class="o">=</span> <span class="nx">handlebars</span><span class="p">;</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">parse</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>Just return if an already-compile AST was passed in.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">input</span><span class="p">;</span> <span class="p">}</span>

  <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Parser</span><span class="p">.</span><span class="nx">yy</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>lib/handlebars/compiler/ast.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ProgramNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">statements</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;program&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">statements</span> <span class="o">=</span> <span class="nx">statements</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">inverse</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">(</span><span class="nx">inverse</span><span class="p">);</span> <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">MustacheNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rawParams</span><span class="p">,</span> <span class="nx">hash</span><span class="p">,</span> <span class="nx">unescaped</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;mustache&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">escaped</span> <span class="o">=</span> <span class="o">!</span><span class="nx">unescaped</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">hash</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">rawParams</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">params</span> <span class="o">=</span> <span class="nx">rawParams</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>a mustache is an eligible helper if:
* its id is simple (a single part, not <code>this</code> or <code>..</code>)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="kd">var</span> <span class="nx">eligibleHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">eligibleHelper</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">isSimple</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>a mustache is definitely a helper if:
* it is an eligible helper, and
* it has at least one parameter or hash segment</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">isHelper</span> <span class="o">=</span> <span class="nx">eligibleHelper</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="nx">hash</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>if a mustache is an eligible helper but not a definite
helper, it is ambiguous, and will be resolved in a later
pass or at runtime.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">PartialNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">partialName</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span>         <span class="o">=</span> <span class="s2">&quot;partial&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">partialName</span>  <span class="o">=</span> <span class="nx">partialName</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">context</span>      <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">BlockNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">,</span> <span class="nx">close</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">verifyMatch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">open</span><span class="p">,</span> <span class="nx">close</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">open</span><span class="p">.</span><span class="nx">original</span> <span class="o">!==</span> <span class="nx">close</span><span class="p">.</span><span class="nx">original</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="nx">open</span><span class="p">.</span><span class="nx">original</span> <span class="o">+</span> <span class="s2">&quot; doesn&#39;t match &quot;</span> <span class="o">+</span> <span class="nx">close</span><span class="p">.</span><span class="nx">original</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">verifyMatch</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">close</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;block&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">mustache</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">program</span>  <span class="o">=</span> <span class="nx">program</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">inverse</span>  <span class="o">=</span> <span class="nx">inverse</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inverse</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isInverse</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ContentNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;content&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">HashNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pairs</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;hash&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">pairs</span> <span class="o">=</span> <span class="nx">pairs</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">IdNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parts</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;ID&quot;</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">original</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nx">dig</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">part</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">part</span><span class="p">;</span>
    <span class="nx">original</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">separator</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">part</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">part</span> <span class="o">===</span> <span class="s2">&quot;..&quot;</span> <span class="o">||</span> <span class="nx">part</span> <span class="o">===</span> <span class="s2">&quot;.&quot;</span> <span class="o">||</span> <span class="nx">part</span> <span class="o">===</span> <span class="s2">&quot;this&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">dig</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid path: &quot;</span> <span class="o">+</span> <span class="nx">original</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span> <span class="o">===</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">depth</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">isScoped</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nx">dig</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">part</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">original</span> <span class="o">=</span> <span class="nx">original</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">parts</span>    <span class="o">=</span> <span class="nx">dig</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">string</span>   <span class="o">=</span> <span class="nx">dig</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">depth</span>    <span class="o">=</span> <span class="nx">depth</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>an ID is simple if it only has one part, and that part is not
<code>..</code> or <code>this</code>.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">isSimple</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isScoped</span> <span class="o">&amp;&amp;</span> <span class="nx">depth</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">stringModeValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">PartialNameNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;PARTIAL_NAME&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">original</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">DataNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;DATA&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">StringNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;STRING&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">original</span> <span class="o">=</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">string</span> <span class="o">=</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stringModeValue</span> <span class="o">=</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">IntegerNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">integer</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;INTEGER&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">original</span> <span class="o">=</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">integer</span> <span class="o">=</span> <span class="nx">integer</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">stringModeValue</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">integer</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">BooleanNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bool</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;BOOLEAN&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">bool</span> <span class="o">=</span> <span class="nx">bool</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">stringModeValue</span> <span class="o">=</span> <span class="nx">bool</span> <span class="o">===</span> <span class="s2">&quot;true&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">CommentNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">comment</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;comment&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">comment</span> <span class="o">=</span> <span class="nx">comment</span><span class="p">;</span>
<span class="p">};</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>lib/handlebars/utils.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="kd">var</span> <span class="nx">errorProps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;fileName&#39;</span><span class="p">,</span> <span class="s1">&#39;lineNumber&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;stack&#39;</span><span class="p">];</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nb">Error</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>Unfortunately errors are not enumerable in Chrome (at least), so <code>for prop in tmp</code> doesn't work.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">idx</span> <span class="o">&lt;</span> <span class="nx">errorProps</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">idx</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">[</span><span class="nx">errorProps</span><span class="p">[</span><span class="nx">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">[</span><span class="nx">errorProps</span><span class="p">[</span><span class="nx">idx</span><span class="p">]];</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>Build out our basic SafeString type</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">SafeString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">SafeString</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">escape</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;&amp;&quot;</span><span class="o">:</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;&lt;&quot;</span><span class="o">:</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;&gt;&quot;</span><span class="o">:</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">,</span>
  <span class="s1">&#39;&quot;&#39;</span><span class="o">:</span> <span class="s2">&quot;&amp;quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span> <span class="s2">&quot;&amp;#x27;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;`&quot;</span><span class="o">:</span> <span class="s2">&quot;&amp;#x60;&quot;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">badChars</span> <span class="o">=</span> <span class="sr">/[&amp;&lt;&gt;&quot;&#39;`]/g</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">possible</span> <span class="o">=</span> <span class="sr">/[&amp;&lt;&gt;&quot;&#39;`]/</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">escapeChar</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chr</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">escape</span><span class="p">[</span><span class="nx">chr</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">extend</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">escapeExpression</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>don't escape SafeStrings, since they're already safe</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">string</span> <span class="k">instanceof</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">SafeString</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">string</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">string</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Force a string conversion as this will be done by the append regardless and
the regex test will do this transparently behind the scenes, causing issues if
an object's to string has escaped characters in it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">possible</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">string</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">string</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">badChars</span><span class="p">,</span> <span class="nx">escapeChar</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">isEmpty</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;[object Array]&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>lib/handlebars/compiler/compiler.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="cm">/*jshint eqnull:true*/</span>
<span class="kd">var</span> <span class="nx">Compiler</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Compiler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
<span class="kd">var</span> <span class="nx">JavaScriptCompiler</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">JavaScriptCompiler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>the foundHelper register will disambiguate helper lookup from finding a
function in a context. This is necessary for mustache compatibility, which
requires that context functions in blocks are evaluated by blockHelperMissing,
and then proceed as if the resulting value was provided to blockHelperMissing.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nx">Compiler</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">compiler</span><span class="o">:</span> <span class="nx">Compiler</span><span class="p">,</span>

  <span class="nx">disassemble</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">opcodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">,</span> <span class="nx">opcode</span><span class="p">,</span> <span class="nx">out</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">param</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opcode</span> <span class="o">=</span> <span class="nx">opcodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">opcode</span> <span class="o">===</span> <span class="s1">&#39;DECLARE&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;DECLARE &quot;</span> <span class="o">+</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">param</span> <span class="o">=</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">param</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">param</span> <span class="o">=</span> <span class="s2">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="nx">param</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">,</span> <span class="s2">&quot;\\n&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">opcode</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">out</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">equals</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">other</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">other</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">opcode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
          <span class="nx">otherOpcode</span> <span class="o">=</span> <span class="nx">other</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">opcode</span> <span class="o">!==</span> <span class="nx">otherOpcode</span><span class="p">.</span><span class="nx">opcode</span> <span class="o">||</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">otherOpcode</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">otherOpcode</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">other</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">equals</span><span class="p">(</span><span class="nx">other</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">guid</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

  <span class="nx">compile</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">depths</span> <span class="o">=</span> <span class="p">{</span><span class="nx">list</span><span class="o">:</span> <span class="p">[]};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>These changes will propagate to the other compiler components</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">knownHelpers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpers</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;helperMissing&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;blockHelperMissing&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;each&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;if&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;unless&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;with&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">&#39;log&#39;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">};</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">knownHelpers</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">knownHelpers</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpers</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">knownHelpers</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">program</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">accept</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">node</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">program</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">statements</span> <span class="o">=</span> <span class="nx">program</span><span class="p">.</span><span class="nx">statements</span><span class="p">,</span> <span class="nx">statement</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">statements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">statement</span> <span class="o">=</span> <span class="nx">statements</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">this</span><span class="p">[</span><span class="nx">statement</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">statement</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isSimple</span> <span class="o">=</span> <span class="nx">l</span> <span class="o">===</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">compileProgram</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">compiler</span><span class="p">().</span><span class="nx">compile</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">guid</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">,</span> <span class="nx">depth</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">usePartial</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">usePartial</span> <span class="o">||</span> <span class="nx">result</span><span class="p">.</span><span class="nx">usePartial</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">guid</span><span class="p">]</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">result</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">depth</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">depth</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="k">continue</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">addDepth</span><span class="p">(</span><span class="nx">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">guid</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">block</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">mustache</span> <span class="o">=</span> <span class="nx">block</span><span class="p">.</span><span class="nx">mustache</span><span class="p">,</span>
        <span class="nx">program</span> <span class="o">=</span> <span class="nx">block</span><span class="p">.</span><span class="nx">program</span><span class="p">,</span>
        <span class="nx">inverse</span> <span class="o">=</span> <span class="nx">block</span><span class="p">.</span><span class="nx">inverse</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">program</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">compileProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">inverse</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">compileProgram</span><span class="p">(</span><span class="nx">inverse</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">classifyMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;helper&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">helperMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;simple&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">simpleMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>now that the simple mustache is resolved, we need to
evaluate it by executing <code>blockHelperMissing</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">program</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;emptyHash&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;blockValue&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ambiguousMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>now that the simple mustache is resolved, we need to
evaluate it by executing <code>blockHelperMissing</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">program</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;emptyHash&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;ambiguousBlockValue&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;append&#39;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">hash</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">pairs</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">pairs</span><span class="p">,</span> <span class="nx">pair</span><span class="p">,</span> <span class="nx">val</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushHash&#39;</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">pairs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">pair</span> <span class="o">=</span> <span class="nx">pairs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">val</span>  <span class="o">=</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">addDepth</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;getContext&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">depth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushStringParam&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">stringModeValue</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">accept</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;assignToHash&#39;</span><span class="p">,</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;popHash&#39;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">partial</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">partial</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">partialName</span> <span class="o">=</span> <span class="nx">partial</span><span class="p">.</span><span class="nx">partialName</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">usePartial</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">partial</span><span class="p">.</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ID</span><span class="p">(</span><span class="nx">partial</span><span class="p">.</span><span class="nx">context</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;push&#39;</span><span class="p">,</span> <span class="s1">&#39;depth0&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;invokePartial&#39;</span><span class="p">,</span> <span class="nx">partialName</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;append&#39;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">content</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;appendContent&#39;</span><span class="p">,</span> <span class="nx">content</span><span class="p">.</span><span class="nx">string</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">mustache</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">classifyMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;simple&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">simpleMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;helper&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">helperMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ambiguousMustache</span><span class="p">(</span><span class="nx">mustache</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">escaped</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">noEscape</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;appendEscaped&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;append&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">ambiguousMustache</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">isBlock</span> <span class="o">=</span> <span class="nx">program</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">inverse</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;getContext&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">program</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;invokeAmbiguous&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">isBlock</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">simpleMustache</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">DATA</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ID</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>Simplified ID for <code>this</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">this</span><span class="p">.</span><span class="nx">addDepth</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;getContext&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushContext&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;resolvePossibleLambda&#39;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">helperMustache</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">setupFullMustacheParams</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">),</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpers</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;invokeKnownHelper&#39;</span><span class="p">,</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpersOnly</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;You specified knownHelpersOnly, but used the unknown helper &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;invokeHelper&#39;</span><span class="p">,</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">ID</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addDepth</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;getContext&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushContext&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;lookupOnContext&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;lookup&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">DATA</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">isScoped</span> <span class="o">||</span> <span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;Scoped data references are not supported: &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">original</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;lookupData&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;lookup&#39;</span><span class="p">,</span> <span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">STRING</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushString&#39;</span><span class="p">,</span> <span class="nx">string</span><span class="p">.</span><span class="nx">string</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">INTEGER</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">integer</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushLiteral&#39;</span><span class="p">,</span> <span class="nx">integer</span><span class="p">.</span><span class="nx">integer</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">BOOLEAN</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushLiteral&#39;</span><span class="p">,</span> <span class="nx">bool</span><span class="p">.</span><span class="nx">bool</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">comment</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>HELPERS</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">opcode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">opcode</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="o">:</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">});</span>
  <span class="p">},</span>

  <span class="nx">declare</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">opcode</span><span class="o">:</span> <span class="s1">&#39;DECLARE&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="nx">value</span> <span class="p">});</span>
  <span class="p">},</span>

  <span class="nx">addDepth</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">depth</span><span class="p">))</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;EWOT&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">depth</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">depths</span><span class="p">[</span><span class="nx">depth</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">depths</span><span class="p">[</span><span class="nx">depth</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">depth</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">classifyMustache</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">isHelper</span>   <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">isHelper</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">isEligible</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">eligibleHelper</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">options</span>    <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>if ambiguous, we can possibly resolve the ambiguity now</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isEligible</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isHelper</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpers</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">isHelper</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">knownHelpersOnly</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">isEligible</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isHelper</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;helper&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isEligible</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;ambiguous&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;simple&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">pushParams</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">param</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">param</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">param</span><span class="p">.</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">addDepth</span><span class="p">(</span><span class="nx">param</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;getContext&#39;</span><span class="p">,</span> <span class="nx">param</span><span class="p">.</span><span class="nx">depth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushStringParam&#39;</span><span class="p">,</span> <span class="nx">param</span><span class="p">.</span><span class="nx">stringModeValue</span><span class="p">,</span> <span class="nx">param</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">[</span><span class="nx">param</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">param</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">setupMustacheParams</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushParams</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;emptyHash&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">params</span><span class="p">;</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>this will replace setupMustacheParams when we're done</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">setupFullMustacheParams</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mustache</span><span class="p">,</span> <span class="nx">program</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">mustache</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushParams</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">program</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;pushProgram&#39;</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">mustache</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">opcode</span><span class="p">(</span><span class="s1">&#39;emptyHash&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">params</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Literal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">JavaScriptCompiler</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>PUBLIC API: You can override these methods in a subclass to provide
alternative compiled forms for name lookup and buffering semantics</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">nameLookup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">name</span> <span class="cm">/* , type*/</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">/^[0-9]+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">parent</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">JavaScriptCompiler</span><span class="p">.</span><span class="nx">isValidJavaScriptVariableName</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">parent</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">parent</span> <span class="o">+</span> <span class="s2">&quot;[&#39;&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">appendToBuffer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">isSimple</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;return &quot;</span> <span class="o">+</span> <span class="nx">string</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">appendToBuffer</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">content</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span>
        <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;buffer += &quot;</span> <span class="o">+</span> <span class="nx">string</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">initializeBuffer</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">quotedString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&quot;Handlebars&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>END PUBLIC API</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

  <span class="nx">compile</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">environment</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">asObject</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">environment</span> <span class="o">=</span> <span class="nx">environment</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

    <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">disassemble</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;\n\n&quot;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isChild</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">context</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">||</span> <span class="p">{</span>
      <span class="nx">programs</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">environments</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">aliases</span><span class="o">:</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">preamble</span><span class="p">();</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackVars</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">registers</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">list</span><span class="o">:</span> <span class="p">[]</span> <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">compileChildren</span><span class="p">(</span><span class="nx">environment</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">opcodes</span> <span class="o">=</span> <span class="nx">environment</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">,</span> <span class="nx">opcode</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">opcodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opcode</span> <span class="o">=</span> <span class="nx">opcodes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">opcode</span> <span class="o">===</span> <span class="s1">&#39;DECLARE&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">[</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">[</span><span class="nx">opcode</span><span class="p">.</span><span class="nx">opcode</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">opcode</span><span class="p">.</span><span class="nx">args</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">createFunctionContext</span><span class="p">(</span><span class="nx">asObject</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">nextOpcode</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">opcodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">opcodes</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">opcodes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
  <span class="p">},</span>

  <span class="nx">eat</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">preamble</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isChild</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">namespace</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">copies</span> <span class="o">=</span> <span class="s2">&quot;helpers = this.merge(helpers, &quot;</span> <span class="o">+</span> <span class="nx">namespace</span> <span class="o">+</span> <span class="s2">&quot;.helpers);&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">usePartial</span><span class="p">)</span> <span class="p">{</span> <span class="nx">copies</span> <span class="o">=</span> <span class="nx">copies</span> <span class="o">+</span> <span class="s2">&quot; partials = this.merge(partials, &quot;</span> <span class="o">+</span> <span class="nx">namespace</span> <span class="o">+</span> <span class="s2">&quot;.partials);&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="nx">copies</span> <span class="o">=</span> <span class="nx">copies</span> <span class="o">+</span> <span class="s2">&quot; data = data || {};&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">copies</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">isSimple</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;, buffer = &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializeBuffer</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>track the last context pushed into place to allow skipping the
getContext opcode when it would be a noop</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="nx">out</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">createFunctionContext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">asObject</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">locals</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackVars</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">registers</span><span class="p">.</span><span class="nx">list</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">locals</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">locals</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>Generate minimizer alias mappings</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isChild</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">alias</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">alias</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">alias</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">[</span><span class="nx">alias</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;var &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">substring</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<p>Merge children</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isChild</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;\n&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">isSimple</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;return buffer;&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">isChild</span> <span class="o">?</span> <span class="p">[</span><span class="s2">&quot;depth0&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">]</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Handlebars&quot;</span><span class="p">,</span> <span class="s2">&quot;depth0&quot;</span><span class="p">,</span> <span class="s2">&quot;helpers&quot;</span><span class="p">,</span> <span class="s2">&quot;partials&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">];</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Perform a second pass over the output to merge content when possible</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mergeSource</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isChild</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">revision</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">COMPILER_REVISION</span><span class="p">,</span>
          <span class="nx">versions</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">REVISION_CHANGES</span><span class="p">[</span><span class="nx">revision</span><span class="p">];</span>
      <span class="nx">source</span> <span class="o">=</span> <span class="s2">&quot;this.compilerInfo = [&quot;</span><span class="o">+</span><span class="nx">revision</span><span class="o">+</span><span class="s2">&quot;,&#39;&quot;</span><span class="o">+</span><span class="nx">versions</span><span class="o">+</span><span class="s2">&quot;&#39;];\n&quot;</span><span class="o">+</span><span class="nx">source</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">asObject</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>

      <span class="k">return</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">functionSource</span> <span class="o">=</span> <span class="s1">&#39;function &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;) {\n  &#39;</span> <span class="o">+</span> <span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
      <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">,</span> <span class="nx">functionSource</span> <span class="o">+</span> <span class="s2">&quot;\n\n&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">functionSource</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">mergeSource</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>WARN: We are not handling the case where buffer is still populated as the source should
not have buffer append operations as their final action.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="nx">buffer</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">appendToBuffer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span> <span class="o">+</span> <span class="s1">&#39;\n    + &#39;</span> <span class="o">+</span> <span class="nx">line</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">line</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">source</span> <span class="o">+=</span> <span class="s1">&#39;buffer += &#39;</span> <span class="o">+</span> <span class="nx">buffer</span> <span class="o">+</span> <span class="s1">&#39;;\n  &#39;</span><span class="p">;</span>
          <span class="nx">buffer</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">source</span> <span class="o">+=</span> <span class="nx">line</span> <span class="o">+</span> <span class="s1">&#39;\n  &#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">source</span><span class="p">;</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>[blockValue]</p>

<p>On stack, before: hash, inverse, program, value
On stack, after: return value of blockHelperMissing</p>

<p>The purpose of this opcode is to take a block of the form
<code>{{#foo}}...{{/foo}}</code>, resolve the value of <code>foo</code>, and
replace it on the stack with the result of properly
invoking blockHelperMissing.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">blockValue</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">blockHelperMissing</span> <span class="o">=</span> <span class="s1">&#39;helpers.blockHelperMissing&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;depth0&quot;</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupParams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">replaceStack</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">current</span><span class="p">);</span>
      <span class="k">return</span> <span class="s2">&quot;blockHelperMissing.call(&quot;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>[ambiguousBlockValue]</p>

<p>On stack, before: hash, inverse, program, value
Compiler value, before: lastHelper=value of last found helper, if any
On stack, after, if no lastHelper: same as [blockValue]
On stack, after, if lastHelper: value</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">ambiguousBlockValue</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">blockHelperMissing</span> <span class="o">=</span> <span class="s1">&#39;helpers.blockHelperMissing&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;depth0&quot;</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupParams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">current</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">topStack</span><span class="p">();</span>
    <span class="nx">params</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">current</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>Use the options value generated from the invocation</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">params</span><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;options&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;if (!&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastHelper</span> <span class="o">+</span> <span class="s2">&quot;) { &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot; = blockHelperMissing.call(&quot;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;); }&quot;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<p>[appendContent]</p>

<p>On stack, before: ...
On stack, after: ...</p>

<p>Appends the string value of <code>content</code> to the current buffer</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">appendContent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">appendToBuffer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">quotedString</span><span class="p">(</span><span class="nx">content</span><span class="p">)));</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40">&#182;</a>
</div>
<p>[append]</p>

<p>On stack, before: value, ...
On stack, after: ...</p>

<p>Coerces <code>value</code> to a String and appends it to the current buffer.</p>

<p>If <code>value</code> is truthy, or 0, it is coerced into a string and appended
Otherwise, the empty string is appended</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">append</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41">&#182;</a>
</div>
<p>Force anything that is inlined onto the stack so we don't have duplication
when we examine local</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">this</span><span class="p">.</span><span class="nx">flushInline</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">local</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;if(&quot;</span> <span class="o">+</span> <span class="nx">local</span> <span class="o">+</span> <span class="s2">&quot; || &quot;</span> <span class="o">+</span> <span class="nx">local</span> <span class="o">+</span> <span class="s2">&quot; === 0) { &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">appendToBuffer</span><span class="p">(</span><span class="nx">local</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; }&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">isSimple</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;else { &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">appendToBuffer</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; }&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>[appendEscaped]</p>

<p>On stack, before: value, ...
On stack, after: ...</p>

<p>Escape <code>value</code> and append it to the buffer</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">appendEscaped</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">escapeExpression</span> <span class="o">=</span> <span class="s1">&#39;this.escapeExpression&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">appendToBuffer</span><span class="p">(</span><span class="s2">&quot;escapeExpression(&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">));</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>[getContext]</p>

<p>On stack, before: ...
On stack, after: ...
Compiler value, after: lastContext=depth</p>

<p>Set the value of the <code>lastContext</code> compiler value to the depth</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">getContext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span> <span class="o">!==</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span> <span class="o">=</span> <span class="nx">depth</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<p>[lookupOnContext]</p>

<p>On stack, before: ...
On stack, after: currentContext[name], ...</p>

<p>Looks up the value of <code>name</code> on the current context and pushes
it onto the stack.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">lookupOnContext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;context&#39;</span><span class="p">));</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>[pushContext]</p>

<p>On stack, before: ...
On stack, after: currentContext, ...</p>

<p>Pushes the value of the current context onto the stack.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">pushContext</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>[resolvePossibleLambda]</p>

<p>On stack, before: value, ...
On stack, after: resolved value, ...</p>

<p>If the <code>value</code> is a lambda, replace it on the stack by
the return value of the lambda</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">resolvePossibleLambda</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">functionType</span> <span class="o">=</span> <span class="s1">&#39;&quot;function&quot;&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">replaceStack</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;typeof &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot; === functionType ? &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot;.apply(depth0) : &quot;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>[lookup]</p>

<p>On stack, before: value, ...
On stack, after: value[name], ...</p>

<p>Replace the value on the stack with the result of looking
up <code>name</code> on <code>value</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">lookup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">replaceStack</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot; == null || &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot; === false ? &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="nx">current</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;context&#39;</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48">&#182;</a>
</div>
<p>[lookupData]</p>

<p>On stack, before: ...
On stack, after: data[id], ...</p>

<p>Push the result of looking up <code>id</code> on the current data</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">lookupData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>[pushStringParam]</p>

<p>On stack, before: ...
On stack, after: string, currentContext, ...</p>

<p>This opcode is designed for use in string mode, which
provides the string value of a parameter along with its
depth rather than resolving it immediately.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">pushStringParam</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">pushString</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">string</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pushString</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">emptyHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;hashTypes&#39;</span><span class="p">,</span> <span class="s1">&#39;{}&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;hashContexts&#39;</span><span class="p">,</span> <span class="s1">&#39;{}&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">pushHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hash</span> <span class="o">=</span> <span class="p">{</span><span class="nx">values</span><span class="o">:</span> <span class="p">[],</span> <span class="nx">types</span><span class="o">:</span> <span class="p">[],</span> <span class="nx">contexts</span><span class="o">:</span> <span class="p">[]};</span>
  <span class="p">},</span>
  <span class="nx">popHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">hash</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hash</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;hashContexts&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">contexts</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;hashTypes&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;{\n    &#39;</span> <span class="o">+</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,\n    &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;\n  }&#39;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>
<p>[pushString]</p>

<p>On stack, before: ...
On stack, after: quotedString(string), ...</p>

<p>Push a quoted version of <code>string</code> onto the stack</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">pushString</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">quotedString</span><span class="p">(</span><span class="nx">string</span><span class="p">));</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>[push]</p>

<p>On stack, before: ...
On stack, after: expr, ...</p>

<p>Push an expression onto the stack</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">push</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">expr</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">expr</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">expr</span><span class="p">;</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<p>[pushLiteral]</p>

<p>On stack, before: ...
On stack, after: value, ...</p>

<p>Pushes a value onto the stack. This operation prevents
the compiler from creating a temporary variable to hold
it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">pushLiteral</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<p>[pushProgram]</p>

<p>On stack, before: ...
On stack, after: program(guid), ...</p>

<p>Push a program expression onto the stack. This takes
a compile-time guid and converts it into a runtime-accessible
expression.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">pushProgram</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">guid</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">guid</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">programExpression</span><span class="p">(</span><span class="nx">guid</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54">&#182;</a>
</div>
<p>[invokeHelper]</p>

<p>On stack, before: hash, inverse, program, params..., ...
On stack, after: result of helper invocation</p>

<p>Pops off the helper's parameters, invokes the helper,
and pushes the helper's return value onto the stack.</p>

<p>If the helper is not found, <code>helperMissing</code> is called.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">invokeHelper</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">helperMissing</span> <span class="o">=</span> <span class="s1">&#39;helpers.helperMissing&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">helper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">setupHelper</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">nonHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;context&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">helper</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; || &#39;</span> <span class="o">+</span> <span class="nx">nonHelper</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">replaceStack</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; ? &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;.call(&#39;</span> <span class="o">+</span>
          <span class="nx">helper</span><span class="p">.</span><span class="nx">callParams</span> <span class="o">+</span> <span class="s2">&quot;) &quot;</span> <span class="o">+</span> <span class="s2">&quot;: helperMissing.call(&quot;</span> <span class="o">+</span>
          <span class="nx">helper</span><span class="p">.</span><span class="nx">helperMissingParams</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55">&#182;</a>
</div>
<p>[invokeKnownHelper]</p>

<p>On stack, before: hash, inverse, program, params..., ...
On stack, after: result of helper invocation</p>

<p>This operation is used when the helper is known to exist,
so a <code>helperMissing</code> fallback is not required.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">invokeKnownHelper</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">helper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">setupHelper</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">helper</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;.call(&quot;</span> <span class="o">+</span> <span class="nx">helper</span><span class="p">.</span><span class="nx">callParams</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56">&#182;</a>
</div>
<p>[invokeAmbiguous]</p>

<p>On stack, before: hash, inverse, program, params..., ...
On stack, after: result of disambiguation</p>

<p>This operation is used when an expression like <code>{{foo}}</code>
is provided, but we don't know at compile-time whether it
is a helper or a path.</p>

<p>This operation emits more code than the other options,
and can be avoided by passing the <code>knownHelpers</code> and
<code>knownHelpersOnly</code> flags at compile-time.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">invokeAmbiguous</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">helperCall</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">functionType</span> <span class="o">=</span> <span class="s1">&#39;&quot;function&quot;&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">pushStackLiteral</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="p">);</span>    <span class="c1">// Hash value</span>
    <span class="kd">var</span> <span class="nx">helper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">setupHelper</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">helperCall</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">helperName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;helpers&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;helper&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">nonHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastContext</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;context&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">nextStack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nextStack</span><span class="p">();</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;if (&#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">helperName</span> <span class="o">+</span> <span class="s1">&#39;) { &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39;.call(&#39;</span> <span class="o">+</span> <span class="nx">helper</span><span class="p">.</span><span class="nx">callParams</span> <span class="o">+</span> <span class="s1">&#39;); }&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;else { &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">nonHelper</span> <span class="o">+</span> <span class="s1">&#39;; &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39; = typeof &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39; === functionType ? &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39;.apply(depth0) : &#39;</span> <span class="o">+</span> <span class="nx">nextStack</span> <span class="o">+</span> <span class="s1">&#39;; }&#39;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57">&#182;</a>
</div>
<p>[invokePartial]</p>

<p>On stack, before: context, ...
On stack after: result of partial invocation</p>

<p>This operation pops off a context, invokes a partial with that context,
and pushes the result of the invocation back.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">invokePartial</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;partials&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;partial&#39;</span><span class="p">),</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">(),</span> <span class="s2">&quot;helpers&quot;</span><span class="p">,</span> <span class="s2">&quot;partials&quot;</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">self</span> <span class="o">=</span> <span class="s2">&quot;this&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;self.invokePartial(&quot;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<p>[assignToHash]</p>

<p>On stack, before: value, hash, ...
On stack, after: hash, ...</p>

<p>Pops a value and hash off the stack, assigns <code>hash[key] = value</code>
and pushes the hash back onto the stack.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">assignToHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">(),</span>
        <span class="nx">context</span><span class="p">,</span>
        <span class="nx">type</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">hash</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">hash</span><span class="p">.</span><span class="nx">contexts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;: &quot;</span> <span class="o">+</span> <span class="nx">context</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">hash</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;: &quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">hash</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;: (&quot;</span> <span class="o">+</span> <span class="nx">value</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">);</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59">&#182;</a>
</div>
<p>HELPERS</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

  <span class="nx">compiler</span><span class="o">:</span> <span class="nx">JavaScriptCompiler</span><span class="p">,</span>

  <span class="nx">compileChildren</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">environment</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">environment</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">child</span><span class="p">,</span> <span class="nx">compiler</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">child</span> <span class="o">=</span> <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">compiler</span> <span class="o">=</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">compiler</span><span class="p">();</span>

      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">matchExistingProgram</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>     <span class="c1">// Placeholder to prevent name conflicts for nested children</span>
        <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="nx">child</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
        <span class="nx">child</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;program&#39;</span> <span class="o">+</span> <span class="nx">index</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">programs</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">compiler</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">environments</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">child</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
        <span class="nx">child</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;program&#39;</span> <span class="o">+</span> <span class="nx">index</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">matchExistingProgram</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">environments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">environment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">environments</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">environment</span> <span class="o">&amp;&amp;</span> <span class="nx">environment</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">child</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">programExpression</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">guid</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">self</span> <span class="o">=</span> <span class="s2">&quot;this&quot;</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">guid</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;self.noop&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">environment</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">guid</span><span class="p">],</span>
        <span class="nx">depths</span> <span class="o">=</span> <span class="nx">child</span><span class="p">.</span><span class="nx">depths</span><span class="p">.</span><span class="nx">list</span><span class="p">,</span> <span class="nx">depth</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">programParams</span> <span class="o">=</span> <span class="p">[</span><span class="nx">child</span><span class="p">.</span><span class="nx">index</span><span class="p">,</span> <span class="nx">child</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">];</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">depths</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">depth</span> <span class="o">=</span> <span class="nx">depths</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">depth</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="nx">programParams</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;depth0&quot;</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nx">programParams</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span><span class="nx">depths</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="s2">&quot;self.program(&quot;</span> <span class="o">:</span> <span class="s2">&quot;self.programWithDepth(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">programParams</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">register</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">useRegister</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nx">val</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">useRegister</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">registers</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">registers</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">registers</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">pushStackLiteral</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Literal</span><span class="p">(</span><span class="nx">item</span><span class="p">));</span>
  <span class="p">},</span>

  <span class="nx">pushStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">flushInline</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">incrStack</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nx">item</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">stack</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">replaceStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="nx">inline</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">isInline</span><span class="p">(),</span>
        <span class="nx">stack</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60">&#182;</a>
</div>
<p>If we are currently inline then we want to merge the inline statement into the
replacement statement via ','</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">top</span> <span class="k">instanceof</span> <span class="nx">Literal</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61">&#182;</a>
</div>
<p>Literals do not need to be inlined</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">stack</span> <span class="o">=</span> <span class="nx">top</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62">&#182;</a>
</div>
<p>Get or create the current stack name for use by the inline</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">topStackName</span><span class="p">()</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">incrStack</span><span class="p">();</span>

        <span class="nx">prefix</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">top</span> <span class="o">+</span> <span class="s1">&#39;),&#39;</span><span class="p">;</span>
        <span class="nx">stack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">topStack</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">stack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">topStack</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">stack</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="nx">item</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63">&#182;</a>
</div>
<p>Prevent modification of the context depth variable. Through replaceStack</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/^stack/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">stack</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">stack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nextStack</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span> <span class="o">+</span> <span class="s2">&quot; = (&quot;</span> <span class="o">+</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="nx">item</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">stack</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">nextStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">();</span>
  <span class="p">},</span>

  <span class="nx">incrStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackVars</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackVars</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;stack&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">topStackName</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">topStackName</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;stack&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">flushInline</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inlineStack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inlineStack</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">inlineStack</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">entry</span> <span class="o">=</span> <span class="nx">inlineStack</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">entry</span> <span class="k">instanceof</span> <span class="nx">Literal</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">isInline</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">popStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">wrapped</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inline</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">isInline</span><span class="p">(),</span>
        <span class="nx">item</span> <span class="o">=</span> <span class="p">(</span><span class="nx">inline</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span><span class="p">).</span><span class="nx">pop</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">wrapped</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Literal</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stackSlot</span><span class="o">--</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">item</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">topStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">wrapped</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isInline</span><span class="p">()</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlineStack</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">compileStack</span><span class="p">),</span>
        <span class="nx">item</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">[</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">wrapped</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Literal</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">item</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">quotedString</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nx">str</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\/g</span><span class="p">,</span> <span class="s1">&#39;\\\\&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span> <span class="s1">&#39;\\&quot;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\r/g</span><span class="p">,</span> <span class="s1">&#39;\\r&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\u2028/g</span><span class="p">,</span> <span class="s1">&#39;\\u2028&#39;</span><span class="p">)</span>   <span class="c1">// Per Ecma-262 7.3 + 7.8.4</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\u2029/g</span><span class="p">,</span> <span class="s1">&#39;\\u2029&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">setupHelper</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">missingParams</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupParams</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">missingParams</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">foundHelper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nameLookup</span><span class="p">(</span><span class="s1">&#39;helpers&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;helper&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">params</span><span class="o">:</span> <span class="nx">params</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="nx">foundHelper</span><span class="p">,</span>
      <span class="nx">callParams</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;depth0&quot;</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">params</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">),</span>
      <span class="nx">helperMissingParams</span><span class="o">:</span> <span class="nx">missingParams</span> <span class="o">&amp;&amp;</span> <span class="p">[</span><span class="s2">&quot;depth0&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">quotedString</span><span class="p">(</span><span class="nx">name</span><span class="p">)].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">params</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
    <span class="p">};</span>
  <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64">&#182;</a>
</div>
<p>the params and contexts arguments are passed in arrays
to fill in</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">setupParams</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">paramSize</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">useRegister</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">contexts</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">types</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">param</span><span class="p">,</span> <span class="nx">inverse</span><span class="p">,</span> <span class="nx">program</span><span class="p">;</span>

    <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;hash:&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">());</span>

    <span class="nx">inverse</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
    <span class="nx">program</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65">&#182;</a>
</div>
<p>Avoid setting fn and inverse if neither are set. This allows
helpers to do a check for <code>if (options.fn)</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">program</span> <span class="o">||</span> <span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">self</span> <span class="o">=</span> <span class="s2">&quot;this&quot;</span><span class="p">;</span>
        <span class="nx">program</span> <span class="o">=</span> <span class="s2">&quot;self.noop&quot;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inverse</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">aliases</span><span class="p">.</span><span class="nx">self</span> <span class="o">=</span> <span class="s2">&quot;this&quot;</span><span class="p">;</span>
        <span class="nx">inverse</span> <span class="o">=</span> <span class="s2">&quot;self.noop&quot;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;inverse:&quot;</span> <span class="o">+</span> <span class="nx">inverse</span><span class="p">);</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;fn:&quot;</span> <span class="o">+</span> <span class="nx">program</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">paramSize</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">param</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">();</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>

      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">types</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">());</span>
        <span class="nx">contexts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">popStack</span><span class="p">());</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stringParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;contexts:[&quot;</span> <span class="o">+</span> <span class="nx">contexts</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">);</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;types:[&quot;</span> <span class="o">+</span> <span class="nx">types</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">);</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;hashContexts:hashContexts&quot;</span><span class="p">);</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;hashTypes:hashTypes&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;data:data&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">options</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">useRegister</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">reservedWords</span> <span class="o">=</span> <span class="p">(</span>
  <span class="s2">&quot;break else new var&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; case finally return void&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; catch for switch while&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; continue function this with&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; default if throw&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; delete in try&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; do instanceof typeof&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; abstract enum int short&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; boolean export interface static&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; byte extends long super&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; char final native synchronized&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; class float package throws&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; const goto private transient&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; debugger implements protected volatile&quot;</span> <span class="o">+</span>
  <span class="s2">&quot; double import public let yield&quot;</span>
<span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">compilerWords</span> <span class="o">=</span> <span class="nx">JavaScriptCompiler</span><span class="p">.</span><span class="nx">RESERVED_WORDS</span> <span class="o">=</span> <span class="p">{};</span>

<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">reservedWords</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">compilerWords</span><span class="p">[</span><span class="nx">reservedWords</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">JavaScriptCompiler</span><span class="p">.</span><span class="nx">isValidJavaScriptVariableName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">JavaScriptCompiler</span><span class="p">.</span><span class="nx">RESERVED_WORDS</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="sr">/^[a-zA-Z_$][0-9a-zA-Z_$]+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">precompile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">input</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">!==</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;You must pass a string or Handlebars AST to Handlebars.precompile. You passed &quot;</span> <span class="o">+</span> <span class="nx">input</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;data&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Compiler</span><span class="p">().</span><span class="nx">compile</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">JavaScriptCompiler</span><span class="p">().</span><span class="nx">compile</span><span class="p">(</span><span class="nx">environment</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">input</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">!==</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">AST</span><span class="p">.</span><span class="nx">ProgramNode</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;You must pass a string or Handlebars AST to Handlebars.compile. You passed &quot;</span> <span class="o">+</span> <span class="nx">input</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;data&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">compiled</span><span class="p">;</span>
  <span class="kd">function</span> <span class="nx">compile</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Compiler</span><span class="p">().</span><span class="nx">compile</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">templateSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JavaScriptCompiler</span><span class="p">().</span><span class="nx">compile</span><span class="p">(</span><span class="nx">environment</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">templateSpec</span><span class="p">);</span>
  <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66">&#182;</a>
</div>
<p>Template is only compiled on first use and cached after that point.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">compiled</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">compiled</span> <span class="o">=</span> <span class="nx">compile</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">compiled</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67">&#182;</a>
</div>
<p>lib/handlebars/runtime.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">template</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">templateSpec</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68">&#182;</a>
</div>
<p>Just add water</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">escapeExpression</span><span class="o">:</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">escapeExpression</span><span class="p">,</span>
      <span class="nx">invokePartial</span><span class="o">:</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">invokePartial</span><span class="p">,</span>
      <span class="nx">programs</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">program</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">programWrapper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">programs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">programWrapper</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">program</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">programWrapper</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">programWrapper</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">programs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">program</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">programWrapper</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="nx">merge</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">param</span><span class="p">,</span> <span class="nx">common</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">param</span> <span class="o">||</span> <span class="nx">common</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">param</span> <span class="o">&amp;&amp;</span> <span class="nx">common</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">ret</span> <span class="o">=</span> <span class="p">{};</span>
          <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">ret</span><span class="p">,</span> <span class="nx">common</span><span class="p">);</span>
          <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">ret</span><span class="p">,</span> <span class="nx">param</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="nx">programWithDepth</span><span class="o">:</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">programWithDepth</span><span class="p">,</span>
      <span class="nx">noop</span><span class="o">:</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">noop</span><span class="p">,</span>
      <span class="nx">compilerInfo</span><span class="o">:</span> <span class="kc">null</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">templateSpec</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="nx">Handlebars</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">helpers</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">partials</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>

      <span class="kd">var</span> <span class="nx">compilerInfo</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">compilerInfo</span> <span class="o">||</span> <span class="p">[],</span>
          <span class="nx">compilerRevision</span> <span class="o">=</span> <span class="nx">compilerInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">currentRevision</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">COMPILER_REVISION</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">compilerRevision</span> <span class="o">!==</span> <span class="nx">currentRevision</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">compilerRevision</span> <span class="o">&lt;</span> <span class="nx">currentRevision</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">runtimeVersions</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">REVISION_CHANGES</span><span class="p">[</span><span class="nx">currentRevision</span><span class="p">],</span>
              <span class="nx">compilerVersions</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">REVISION_CHANGES</span><span class="p">[</span><span class="nx">compilerRevision</span><span class="p">];</span>
          <span class="k">throw</span> <span class="s2">&quot;Template was precompiled with an older version of Handlebars than the current runtime. &quot;</span><span class="o">+</span>
                <span class="s2">&quot;Please update your precompiler to a newer version (&quot;</span><span class="o">+</span><span class="nx">runtimeVersions</span><span class="o">+</span><span class="s2">&quot;) or downgrade your runtime to an older version (&quot;</span><span class="o">+</span><span class="nx">compilerVersions</span><span class="o">+</span><span class="s2">&quot;).&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69">&#182;</a>
</div>
<p>Use the embedded version info since the runtime doesn't know about this revision yet</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">throw</span> <span class="s2">&quot;Template was precompiled with a newer version of Handlebars than the current runtime. &quot;</span><span class="o">+</span>
                <span class="s2">&quot;Please update your runtime to a newer version (&quot;</span><span class="o">+</span><span class="nx">compilerInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;).&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">},</span>

  <span class="nx">programWithDepth</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">data</span> <span class="cm">/*, $depth */</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">program</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

      <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="nx">data</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">args</span><span class="p">));</span>
    <span class="p">};</span>
    <span class="nx">program</span><span class="p">.</span><span class="nx">program</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">program</span><span class="p">.</span><span class="nx">depth</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">program</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">program</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">program</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

      <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">program</span><span class="p">.</span><span class="nx">program</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">program</span><span class="p">.</span><span class="nx">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">program</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">noop</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">},</span>
  <span class="nx">invokePartial</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">partial</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">helpers</span><span class="p">,</span> <span class="nx">partials</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">helpers</span><span class="o">:</span> <span class="nx">helpers</span><span class="p">,</span> <span class="nx">partials</span><span class="o">:</span> <span class="nx">partials</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span> <span class="p">};</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">partial</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;The partial &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot; could not be found&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">partial</span> <span class="k">instanceof</span> <span class="nb">Function</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">partial</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;The partial &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot; could not be compiled when running in runtime-only mode&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">partials</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">partial</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span> <span class="nx">data</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">});</span>
      <span class="k">return</span> <span class="nx">partials</span><span class="p">[</span><span class="nx">name</span><span class="p">](</span><span class="nx">context</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Handlebars</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">VM</span><span class="p">.</span><span class="nx">template</span><span class="p">;</span>
<span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70">&#182;</a>
</div>
<p>lib/handlebars/browser-suffix.js</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="p">})(</span><span class="nx">Handlebars</span><span class="p">);</span>
<span class="p">;</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
